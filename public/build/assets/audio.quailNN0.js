const s=function(){class r{constructor(t){if(this.player=t,this.audioSrc=this.player.dataset.audio,!this.audioSrc)throw new Error("No audio source specified in data-audio attribute");this.playPauseBtn=this.player.querySelector("[data-play]"),this.playIcon=this.playPauseBtn.querySelector("[data-icon-play]"),this.pauseIcon=this.playPauseBtn.querySelector("[data-icon-pause]"),this.rewindBtn=this.player.querySelector("[data-rewind]"),this.forwardBtn=this.player.querySelector("[data-forward]"),this.progressBar=this.player.querySelector("[data-progress]"),this.progressHandle=this.player.querySelector("[data-handle]"),this.progressContainer=this.player.querySelector("[data-progress-container]"),this.currentTimeEl=this.player.querySelector("[data-current-time]"),this.durationEl=this.player.querySelector("[data-duration]"),this.validateElements(),this.audio=new Audio(this.audioSrc),this.bindMethods(),this.initializeEventListeners(),this.initializeState()}validateElements(){const t={playPauseBtn:"[data-play]",rewindBtn:"[data-rewind]",forwardBtn:"[data-forward]",progressBar:"[data-progress]",progressHandle:"[data-handle]",progressContainer:"[data-progress-container]",currentTimeEl:"[data-current-time]",durationEl:"[data-duration]"};for(const[e,a]of Object.entries(t))if(!this[e])throw new Error(`Required element "${a}" not found in audio player`)}bindMethods(){this.togglePlayPause=this.togglePlayPause.bind(this),this.updateProgress=this.updateProgress.bind(this),this.seek=this.seek.bind(this),this.setProgress=this.setProgress.bind(this)}initializeState(){this.currentTimeEl.textContent="0:00",this.durationEl.textContent="0:00",this.progressBar.style.width="0%",this.progressHandle.style.left="0%"}togglePlayPause(){this.audio.paused&&document.querySelectorAll('[data-player="audio"]').forEach(t=>{const e=t.audioPlayer;e&&e!==this&&!e.audio.paused&&e.togglePlayPause()}),this.audio.paused?this.audio.play().then(()=>{this.playIcon.classList.add("hidden"),this.pauseIcon.classList.remove("hidden")}).catch(t=>{console.error("Error playing audio:",t)}):(this.audio.pause(),this.playIcon.classList.remove("hidden"),this.pauseIcon.classList.add("hidden"))}updateProgress(){if(!this.audio.duration)return;const t=this.audio.currentTime/this.audio.duration*100;this.progressBar.style.width=`${t}%`,t<98&&(this.progressHandle.style.left=`${t}%`),this.currentTimeEl.textContent=this.formatTime(this.audio.currentTime)}formatTime(t){const e=Math.floor(t/60),a=Math.floor(t%60);return`${e}:${a.toString().padStart(2,"0")}`}seek(t){const e=Math.max(0,Math.min(this.audio.duration,this.audio.currentTime+t));isFinite(e)&&(this.audio.currentTime=e)}setProgress(t){const e=this.progressContainer.getBoundingClientRect(),a=t.clientX-e.left,l=Math.min(Math.max(0,a/e.width),1);isFinite(this.audio.duration)&&(this.audio.currentTime=l*this.audio.duration)}initializeEventListeners(){this.audio.addEventListener("loadedmetadata",()=>{this.durationEl.textContent=this.formatTime(this.audio.duration)}),this.audio.addEventListener("timeupdate",this.updateProgress),this.audio.addEventListener("ended",()=>{this.playIcon.classList.remove("hidden"),this.pauseIcon.classList.add("hidden")}),this.playPauseBtn.addEventListener("click",this.togglePlayPause),this.rewindBtn.addEventListener("click",()=>this.seek(-10)),this.forwardBtn.addEventListener("click",()=>this.seek(10)),this.progressContainer.addEventListener("click",this.setProgress.bind(this)),this.player.audioPlayer=this,document.addEventListener("keydown",t=>{if(!(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA"))switch(t.code){case"Space":t.preventDefault(),this.togglePlayPause();break;case"ArrowLeft":this.seek(-5);break;case"ArrowRight":this.seek(5);break}})}}function o(){document.querySelectorAll('[data-player="audio"]').forEach(i=>{const t=i.audioPlayer;t&&!t.audio.paused&&t.togglePlayPause()})}function n(){document.querySelectorAll('[data-player="audio"]').forEach(i=>{const t=i.audioPlayer;t&&(t.audio.pause(),t.audio.currentTime=0)})}function d(){document.querySelectorAll('[data-player="audio"]').forEach(t=>{try{new r(t)}catch(e){console.error("Error initializing audio player:",e)}})}return{init:d,pauseAllPlayers:o,stopAllPlayers:n}}(),u=s.stopAllPlayers;document.addEventListener("DOMContentLoaded",s.init);export{u as s};
